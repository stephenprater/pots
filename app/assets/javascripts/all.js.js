// Generated by CoffeeScript 1.3.1
var __slice = [].slice;

$(function() {
  var Search;
  Array.prototype.remove = function(e) {
    var t, _ref;
    if ((t = this.indexOf(e)) > -1) {
      return ([].splice.apply(this, [t, t - t + 1].concat(_ref = [])), _ref);
    }
  };
  return Search = (function() {

    Search.name = 'Search';

    function Search(selector, base_path) {
      this.selector = selector;
      this.base_path = base_path;
    }

    Search.prototype.reset = function() {
      return $(this.selector).data('url', {});
    };

    Search.prototype.add_params = function(options) {
      var new_params, old;
      old = $(this.selector).data('url');
      new_params = $.extend(old, options);
      return $(this.selector).data('url', new_params);
    };

    Search.prototype.remove_params = function() {
      var key, keys, old, _i, _len;
      keys = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
      old = $(this.selector).data('url');
      for (_i = 0, _len = keys.length; _i < _len; _i++) {
        key = keys[_i];
        delete old[key];
      }
      return $(this.selector).data('url', old);
    };

    Search.prototype.merge_param = function(obj) {
      var k, old, v, _results;
      old = $(this.selector).data('url');
      _results = [];
      for (k in obj) {
        v = obj[k];
        if (old[k]) {
          _results.push(old[k].push(v));
        } else {
          _results.push(old[k] = [v]);
        }
      }
      return _results;
    };

    Search.prototype.unmerge_param = function(obj) {
      var k, old, v, _results;
      old = $(this.selector).data('url');
      _results = [];
      for (k in obj) {
        v = obj[k];
        if (old[k]) {
          old[k].remove(v);
        }
        if (old[k].length === 0) {
          _results.push(delete old[k]);
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    Search.prototype.to_s = function() {
      console.log($(this.selector).data('url'));
      return "" + this.base_path + "?" + (jQuery.param($('#parties').data('url')));
    };

    window.Search = Search;

    return Search;

  })();
});
